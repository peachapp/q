# `vue`中的虚拟`DOM`

## 虚拟`DOM`是什么

`vue`中的虚拟`DOM`是一种抽象层面的概念，它使得`vue`可以高效地更新`DOM`。虚拟`DOM`是由`vue`实例的`$el`属性表示的真实`DOM`元素。虚拟`DOM`的工作原理是：`vue`会在内存中维护一个表示`DOM`结构的树形数据，通常称之为`VNode`。当`vue`实例的数据发生变化时，`vue`会重新生成虚拟`DOM`，并比对新旧虚拟`DOM`之间的差异，最后只将变化的部分应用到真实的`DOM`上，而不是重新渲染整个视图。

虚拟`DOM`的本质是`js`对象，虚拟`DOM`的三要素：`target（不可缺少）`、`attr`、`children`。`vue`中通过虚拟`DOM`，使用`document.createElement`创建真实的`DOM`。

```js
let obj = {
  target: "ul", // 不可缺少
  attr: "abc",
  children: [
    {
      target: "li",
    },
  ],
};
```

## 虚拟`DOM`的优点

1. 性能优化：虚拟`DOM`通过减少不必要的`DOM`操作，提高渲染性能。它使用一个高效的`diff`算法来计算出真正需要更新的节点，最大限度地减少`DOM`操作，从而提高性能。
2. 抽象化`DOM`操作：由于虚拟`DOM`以`js`对象为基础，不依赖真实平台环境，因此可以跨平台操作，例如在浏览器平台、`Weex`、`Node`等环境中使用。
3. 无需手动操作`DOM`：`vue`的虚拟`DOM`可以自动处理视图更新，开发者只需要关注数据变化，无需手动操作`DOM`，大大提高了开发效率。

## 虚拟`DOM`的缺点

1. 首次渲染大量`DOM`时性能较差：由于虚拟`DOM`需要进行计算和比较，所以在首次渲染大量`DOM`时，可能会比直接操作`DOM`慢。
2. 不适合小型项目：对于小型项目或简单页面，使用虚拟`DOM`可能会增加额外的计算开销，此时直接操作`DOM`可能更为简单高效。

## 虚拟`DOM`如何提升`vue`的渲染效率

- 初次渲染时，渲染完成后会保存对应的虚拟`DOM`（js 对象）。
- 更新节点时，会重新生成一份虚拟`DOM`，与之前保存的虚拟`DOM`做比较（`diff`算法），然后对变化的部分做局部更新。
- 将直接操作`DOM`（影响浏览器性能），转变成`js`对象的比较（执行效率上的问题）。
